<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" class="logo" width="120"/>

# 법원 제출용 메일박스 증거 분류 시스템 개발 요청서

## 1. 개요

이 문서는 **한국 법원 증거 제출 규정**과 **디지털 포렌식 무결성** 요구사항을 모두 충족하는 메일박스 증거 분류 시스템의 개발을 위해 Gemini AI에 전달할 상세 요청서입니다.
특히, 관련 없는 메일 자동 제외 프로세스를 포함하여, 실제 법원 제출에 바로 사용할 수 있는 수준의 신뢰성과 실효성을 보장합니다.

## 2. 법적 및 기술적 요구사항

### 2.1 한국 법원의 디지털 증거 제출 규정

- **증거번호 표기:** "갑 제○호증" 또는 "을 제○호증"을 파일 상단 중앙에 명시
- **첨부파일 원본성 보존:** 첨부파일은 원본 그대로 별도 디렉토리에 저장
- **무결성 검증:** SHA-256 해시값 계산 및 체인 오브 커스터디(연계보관성) 관리


### 2.2 디지털 포렌식 표준

- **원본성, 무결성, 신뢰성** 확보
- **처리 과정 로그 기록** 및 검증 가능성 확보


## 3. 시스템 아키텍처 및 워크플로우

### 3.1 전체 처리 흐름 (10단계)

1. 메일박스 파일 입력 및 파싱
2. 인코딩 자동 복구(UTF-8, EUC-KR, CP949 등)
3. 이메일 스레드 및 회신 관계 분석
4. **관련 없는 메일 자동 필터링**
5. 증거 분류 및 번호 할당
6. 첨부파일 원본 추출 및 저장
7. 해시값(SHA-256) 계산 및 기록
8. 법원 제출용 PDF 변환 및 증거번호 삽입
9. 증거목록(Excel) 및 처리 로그 생성
10. 최종 산출물 패키징 및 백업

### 3.2 시스템 컴포넌트 구조

| 컴포넌트 | 주요 역할 |
| :-- | :-- |
| EmailEvidenceProcessor | 전체 프로세스 관리 |
| MboxParser | 메일박스 파싱 및 인코딩 복구 |
| ThreadAnalyzer | 스레드/회신 관계 분석 |
| EvidenceClassifier | 증거 분류 및 번호 할당 |
| AttachmentHandler | 첨부파일 추출 및 원본 저장 |
| IntegrityManager | 무결성(해시) 관리 |
| CourtFormatter | 법원 제출 형식 변환 |
| ReportGenerator | 증거목록/로그/보고서 생성 |

## 4. 관련 없는 메일 자동 제외 프로세스

### 4.1 필터링 기준

- **키워드 기반:** 광고, 뉴스레터, 시스템 알림 등 제외
- **도메인 기반:** noreply@, news@ 등 제외
- **기간 제한:** 사건 관련 기간 이외 메일 제외
- **스레드/회신 관계:** 관련 없는 단독 메일 제외


### 4.2 사용자 정의 필터링 규칙 (예시)

```json
{
  "exclude_keywords": ["광고", "프로모션", "뉴스레터"],
  "exclude_domains": ["noreply@", "news@"],
  "date_range": {
    "start": "2023-01-01",
    "end": "2023-12-31"
  }
}
```


### 4.3 자동 분류 및 로그 기록

- 필터링된 메일은 `/output/excluded/` 폴더에 저장
- 제외 사유를 로그에 기록
- 최종 증거목록에 필터링 내역 명시


### 4.4 수동 검토 옵션

- 자동 필터링 후, 사용자가 최종 확인/복원 가능(엑셀 목록 또는 간단 UI 제공)


## 5. 프로그램 구현 예시 구조

### 5.1 주요 클래스 설계

- EmailEvidenceProcessor (메인 컨트롤러)
- MboxParser (메일박스 파싱)
- ThreadAnalyzer (스레드 분석)
- EvidenceClassifier (증거 분류/번호 할당)
- AttachmentHandler (첨부파일 처리)
- IntegrityManager (무결성 관리)
- CourtFormatter (법원 형식 변환)
- ReportGenerator (보고서/목록 생성)


### 5.2 필수 라이브러리

- 표준: os, sys, logging, hashlib, json
- 외부: pandas, openpyxl, reportlab


## 6. 출력 구조 및 사용법

### 6.1 실행 명령 예시

```bash
python email_evidence_processor.py input.mbox --party 갑 --config config.json
```


### 6.2 산출물 폴더 구조

```
/output/
├── evidence_files/    # PDF 증거 파일
├── attachments/       # 첨부파일 원본
├── reports/           # Excel 증거목록
├── hashes/            # 해시값
├── excluded/          # 필터링된 메일
└── logs/              # 처리 로그
```


## 7. 법원 제출 시 고려사항 및 권장사항

- **법적 요구사항 준수**: 증거번호 표기, 첨부파일 원본 보존, 해시값 기록
- **무결성 보장**: 모든 증거 파일 해시값 및 로그 기록
- **에러 처리**: 다양한 메일박스/인코딩 문제 대응
- **사용자 친화성**: 명확한 로그, 진행상황 표시, 수동 검토 옵션
- **모듈화 설계**: 각 기능별 독립적 테스트 가능


## 8. Gemini AI 요청용 최종 문구 예시

> "메일박스 파일에서 **관련 없는 메일을 자동으로 제외**하는 필터링 프로세스를 포함해 주세요.
> - 제외 기준은 키워드, 발신자/수신자 도메인, 기간, 스레드 관계 등으로 설정 파일에서 쉽게 조정할 수 있어야 합니다.
> - 필터링된 메일은 별도 폴더에 저장하고, 제외 사유를 로그로 남겨야 합니다.
> - 필요시 사용자가 최종 검토 및 복원할 수 있는 옵션도 제공해 주세요."

## 9. 체크리스트

- [x] 법원 증거 제출 규정 준수
- [x] 무결성(해시값) 관리
- [x] 첨부파일 원본성 보존
- [x] 관련 없는 메일 자동 제외 및 로그 기록
- [x] 사용자 정의 필터링 규칙 적용
- [x] 수동 검토/복원 옵션 제공
- [x] 명확한 산출물 폴더 구조
- [x] 모듈화/테스트 가능 구조


## 10. 참고 및 주의사항

- **대용량 파일 대응**: 스트리밍 방식 적용
- **개인정보 보호**: 민감 정보 마스킹 옵션
- **백업/복구**: 중간 결과 저장, 장애 대비

이 문서를 복사하여 Markdown(.md) 파일로 저장하거나, PDF 변환 도구를 통해 PDF로 변환하여 활용하실 수 있습니다.
실제 프로젝트 진행 시, 위 요구사항을 Gemini AI에 전달하면 법원 제출용으로 신뢰할 수 있는 전문 시스템을 개발할 수 있습니다.

